<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <title>收货地址</title>
    <style>
        .measureTable ul{border:1px solid #dedede; margin-top:20px;}
        .measureTable ul >li{text-align: center; padding:10px 0; }
        .measure_bottom ul li{text-align: center; padding:15px 0;border:1px solid #dedede;border-top: none;}
        .measure_bottom ul li a{margin-right: 15px;}
        .btn_add{margin-left: 85%; margin-top: 10px;}
    </style>
</head>
<body>
<div class="header clearfix">
    <a href="javascript:;">
        <img src="../image/xbxm.png" />
    </a>

    <a href="javascript:;">
        <img src="../image/login.png" />
    </a>
    <ol>
        <li>退出</li>
        <i></i>
        <li>通知</li>
        <i></i>
        <li>admin</li>
    </ol>

</div>
<div id="header" class="header clearfix">
    <ul>
        <li><span class="head_active">店铺管理</span></li>
        <li><span>商品管理</span></li>
        <li><span>仓储管理</span></li>
        <li><span>订单管理</span></li>
    </ul>
</div>
<div id="box" class="clearfix">
    <div class="left">
        <ul>
            <li>
                <span>店铺信息</span>
                <ul>
                    <li>店铺资料</li>
                </ul>
            </li>
            <li>
                <span >模板管理</span>
                <ul>
                    <li>测量模板</li>
                </ul>
            </li>
            <li>
                <span >地址管理</span>
                <ul>
                    <li class="first">收货地址</li>
                </ul>
            </li>
        </ul>
    </div>
    <div class="right">
        <div class="container clearfix">
            <p class="right_p router">1》2》3</p>
            <h5>收货信息</h5>
            <button class="btn btn-default btn_add"> 添加收货人</button>
            <div class="goods_box">
                
            </div>
        </div>
    </div>
</div>
<div class="footer">
    <p> CopyRight ? 2011--2014 WWW.BOOM.COM.CN ALL RIGHT RESERVED</p>

    <p> 西藏新博美商业管理连锁股份有限公司 版权所有 技术支持：明腾-西部商务网</p>

    <p> ICP经营许可证编号：藏ICP备16000239号-1 | 藏公安网备54222102000009号</p>
</div>
<script src="../js/jquery-1.12.4.min.js"></script>
<script src="../js/common.js"></script>
<script src="../js/jquery-1.12.4.min.js"></script>
<script>
      // 列表页
      rewriteAjax({
          url :'http://172.16.40.153:8009/shop/findReceiveAddressByShopId',
          data : {
              "shopId" : "11010104"
          },
      },function (data) {
          if (data.success){
              var data=data.data;
              var html=''
              html+=' <div class="measureTable">'
              html+='<ul class="clearfix">'
              html+='<li class="col-sm-3">联系人</li>'
              html+='<li class="col-sm-2">联系电话</li></li>'
              html+='<li class="col-sm-2">收货地址</li>'
              html+='<li class="col-sm-5">操作</li>'
              html+=' </ul>'
              html+=' </div>'
              for ( var i=0;i<data.length;i++){
                  html+='<div class="measure_bottom">'
                  html+='<ul class="clearfix">'
                  html+='<li class="col-sm-3">'+data[i].receiverName+'</li>'
                  html+='<li class="col-sm-2">'+data[i]. receiverTelephone+'</li>'
                  html+='<li class="col-sm-2">'+data[i].shopAddress+'</li>'
                  html+='<li class="col-sm-5" addressId="'+data[i].id+'" state="'+data[i].defaultAddressState+'"><a href="javascript:;" class="defaultAddress">'
                  if(data[i].defaultAddressState==0){
                      html+='设为默认'
                  }else if (data[i].defaultAddressState==1){
                      html+='默认地址'
                  }
                  html+='</a>' +
                      '<a href="javascript:;" class="edits">编辑</a>' +
                      '<a href="javascript:;" class="delete">删除</a>' +
                      '</li>'
                  html+='</ul>'
                  html+='</div>'
              }
          }
          $('.goods_box').append(html);
      })
      
      // 点击默认地址
      $('.goods_box').on("click",".defaultAddress",function () {
              var addressId=$(this).parent().attr("addressId");
              var state=$(this).parent().attr("state");
              rewriteAjax({
                  url :'http://172.16.40.153:8009/shop/setDefaultAddress',
                  data:{
                      id:addressId,
                      state:state
                  },
              },function (data) {
                  if (data.success){
                      window.location.reload();  //刷新页面
                  }
              })
      })
      // 点击编辑
      $('.edits').on('click','.edits',function () {
          // alert(11)
          sessionStorage.setItem('dataId',$(this).parent().attr("addressId"));
          window.location.href='goods_edit.html'
      })

      // 点击删除
      $('.delete').on('click','.delete',function () {
          var addressId=$(this).parent().attr("addressId");
          var that=this;
          rewriteAjax({
              url :'http://172.16.40.153:8009/shop/deleteShopReceiveInfoById',
              data:{
                  id:addressId
              },
          },function (data) {
              $(that).parent().parent().parent().remove();
          })

      })
    // 点击添加收货人
      function add(){
          $('.btn_add').click(function () {
              // alert(11)
              window.location.href='goods_edit.html'

          })
      }
      add();

</script>
</body>
</html>